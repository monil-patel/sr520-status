<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SR 520 Bridge Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0d9488',
                        safe: '#10b981',
                        caution: '#f59e0b',
                        warning: '#ef4444',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen">
    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center">
                    <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                </div>
                <span class="font-semibold text-slate-700">Bridge Status</span>
            </div>
            <div class="flex items-center gap-2 px-4 py-2 bg-slate-50 rounded-lg border border-slate-200">
                <span class="text-sm text-slate-600">Seattle, WA</span>
                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
            </div>
        </div>
    </header>

    <div id="app" class="max-w-4xl mx-auto p-6">
        <!-- Main Status Card -->
        <div id="status" class="mb-6">
            <!-- Will be populated by JavaScript -->
        </div>

        <!-- Stats Cards -->
        <div id="stats" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
            <!-- Will be populated by JavaScript -->
        </div>

        <!-- 7-Day Forecast -->
        <div id="forecast-section" class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-slate-800">Upcoming Status</h2>
                <a href="https://sr520construction.com" target="_blank" class="text-primary text-sm font-medium hover:underline">View Full Schedule</a>
            </div>
            <div id="forecast" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>

        <!-- Details (closures) -->
        <div id="details" class="mb-6">
            <!-- Will be populated by JavaScript -->
        </div>

        <!-- Footer -->
        <footer class="text-center py-8 border-t border-slate-200 mt-8">
            <p class="text-slate-500 text-sm">
                <span id="last-updated">Last updated: Just now</span> • 
                Data Source: <a href="https://sr520construction.com" target="_blank" class="text-primary hover:underline">Dept. of Transportation</a> • 
                <a href="#" class="text-primary hover:underline">Privacy Policy</a>
            </p>
            <button onclick="fetchSR520Data()" 
                    class="mt-4 px-4 py-2 bg-slate-200 hover:bg-slate-300 rounded-lg text-sm text-slate-600 transition-colors inline-flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                </svg>
                Refresh
            </button>
        </footer>
    </div>

    <script>
        const CORS_PROXY = 'https://corsproxy.io/?';
        const SR520_URL = 'https://sr520construction.com/';

        async function fetchSR520Data() {
            try {
                showLoading();
                
                // Fetch the page through CORS proxy
                const response = await fetch(CORS_PROXY + encodeURIComponent(SR520_URL));
                const html = await response.text();
                
                // Parse HTML
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // Extract closures
                const closures = extractClosures(doc);
                
                // Update UI
                updateUI(closures);
                
            } catch (error) {
                console.error('Error fetching SR 520 data:', error);
                showError();
            }
        }

        function isBridgeBlocked(description) {
            const lower = description.toLowerCase();
            
            // Keywords that mean the BRIDGE itself is closed (based on real WSDOT phrases)
            const bridgeBlockedKeywords = [
                // Both directions - from real examples
                'sr 520 closed in both directions',
                'sr 520 will close in both directions',
                'sr 520 will be closed in both directions',
                '520 closed in both directions',
                '520 will close in both directions',
                
                // Eastbound closures - from real examples
                'eastbound sr 520 closed between',
                'eastbound sr 520 will close',
                'eastbound sr 520 will be closed',
                'eastbound 520 closed between',
                'eastbound sr 520 between',  // "Eastbound SR 520 between I-5 and Montlake will close"
                'eastbound lanes of sr 520',
                'all eastbound lanes',
                
                // Westbound closures - from real examples
                'westbound sr 520 closed',
                'westbound sr 520 will close',
                'westbound sr 520 will be closed',
                'westbound 520 closed',
                'westbound sr 520 between',  // "Westbound SR 520 between 92nd and I-5 will be closed"
                'westbound lanes of sr 520',
                'all westbound lanes',
                
                // Across lake variants - from real examples
                'closed across lake washington',
                '520 closed across lake',
                'sr 520 closed across',
                
                // General activity types
                'full highway closure',
                'complete highway closure'
            ];
            
            // Exclude if it's NOT the bridge (ramps, exits, streets)
            const notBridgeKeywords = [
                'off-ramp',
                'on-ramp',
                'ramp to',
                'ramp from',
                'exit',
                'entrance',
                'street',
                'st.',
                'ave',
                'avenue',
                'blvd',
                'boulevard',
                'trail',
                'path',
                'sidewalk'
            ];
            
            // First check: if it contains non-bridge keywords, it's NOT a bridge closure
            if (notBridgeKeywords.some(keyword => lower.includes(keyword))) {
                return false;
            }
            
            // Second check: does it match any bridge closure patterns?
            return bridgeBlockedKeywords.some(keyword => lower.includes(keyword));
        }

        function extractClosures(doc) {
            const closures = {
                today: [],
                upcoming: [],
                bridgeBlockedToday: false,
                bridgeBlockedUpcoming: false
            };

            // Find "Closures today" section
            const headers = Array.from(doc.querySelectorAll('h2'));
            const todayHeader = headers.find(h => h.textContent.includes('Closures today'));
            
            if (todayHeader) {
                let nextEl = todayHeader.nextElementSibling;
                while (nextEl && !nextEl.matches('h2')) {
                    const links = nextEl.querySelectorAll('a');
                    links.forEach(link => {
                        const text = link.textContent.trim();
                        const href = link.getAttribute('href');
                        if (text && href) {
                            const blocked = isBridgeBlocked(text);
                            if (blocked) {
                                closures.bridgeBlockedToday = true;
                            }
                            closures.today.push({
                                description: text,
                                link: href.startsWith('http') ? href : 'https://sr520construction.com' + href,
                                bridgeBlocked: blocked
                            });
                        }
                    });
                    nextEl = nextEl.nextElementSibling;
                    if (nextEl && nextEl.matches('h2')) break;
                }
            }

            // Find "Upcoming closures" section
            const upcomingHeader = headers.find(h => h.textContent.includes('Upcoming closures'));
            
            if (upcomingHeader) {
                let nextEl = upcomingHeader.nextElementSibling;
                while (nextEl && !nextEl.matches('h2, footer')) {
                    const links = nextEl.querySelectorAll('a');
                    links.forEach(link => {
                        const text = link.textContent.trim();
                        const href = link.getAttribute('href');
                        if (text && href && !closures.today.find(c => c.description === text)) {
                            const blocked = isBridgeBlocked(text);
                            if (blocked) {
                                closures.bridgeBlockedUpcoming = true;
                            }
                            closures.upcoming.push({
                                description: text,
                                link: href.startsWith('http') ? href : 'https://sr520construction.com' + href,
                                bridgeBlocked: blocked
                            });
                        }
                    });
                    nextEl = nextEl.nextElementSibling;
                    if (!nextEl || nextEl.matches('footer')) break;
                }
            }

            return closures;
        }

        function updateUI(closures) {
            const statusEl = document.getElementById('status');
            const statsEl = document.getElementById('stats');
            const forecastEl = document.getElementById('forecast');
            const detailsEl = document.getElementById('details');
            const lastUpdatedEl = document.getElementById('last-updated');

            // Main Status Card
            if (closures.bridgeBlockedToday) {
                // Bridge is BLOCKED today
                statusEl.innerHTML = `
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 relative overflow-hidden">
                        <div class="absolute top-6 right-6 w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="inline-flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-full text-sm font-medium mb-4">
                            <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                            STATUS: CLOSED
                        </div>
                        <h1 class="text-4xl font-bold text-slate-800 mb-3">SR 520 Floating Bridge</h1>
                        <p class="text-slate-500 text-lg mb-6 max-w-lg">The bridge is currently closed. Consider using I-90 as an alternate route across Lake Washington.</p>
                        <div class="flex gap-3">
                            <a href="https://wsdot.com/travel/real-time/cameras" target="_blank" 
                               class="px-5 py-2.5 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors">
                                View Traffic Cam
                            </a>
                            <a href="https://sr520construction.com" target="_blank" 
                               class="px-5 py-2.5 bg-white border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors">
                                Details
                            </a>
                        </div>
                    </div>
                `;
            } else {
                // Bridge is OPEN
                statusEl.innerHTML = `
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 relative overflow-hidden">
                        <div class="absolute top-6 right-6 w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-primary" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-50 text-emerald-600 rounded-full text-sm font-medium mb-4">
                            <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
                            STATUS: OPEN
                        </div>
                        <h1 class="text-4xl font-bold text-slate-800 mb-3">SR 520 Floating Bridge</h1>
                        <p class="text-slate-500 text-lg mb-6 max-w-lg">Current conditions are favorable with normal traffic flow in both directions. Drive safely and enjoy the view.</p>
                        <div class="flex gap-3">
                            <a href="https://wsdot.com/travel/real-time/cameras" target="_blank" 
                               class="px-5 py-2.5 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors">
                                View Traffic Cam
                            </a>
                            <a href="https://sr520construction.com" target="_blank" 
                               class="px-5 py-2.5 bg-white border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors">
                                Details
                            </a>
                        </div>
                    </div>
                `;
            }

            // Stats Cards
            const totalClosures = closures.today.length + closures.upcoming.length;
            const bridgeClosures = closures.today.filter(c => c.bridgeBlocked).length + closures.upcoming.filter(c => c.bridgeBlocked).length;
            
            statsEl.innerHTML = `
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-xs font-medium text-slate-400 uppercase tracking-wide">Today's Closures</span>
                        <div class="w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-slate-800">${closures.today.length}</div>
                    <div class="text-sm text-slate-500">Active now</div>
                    <div class="mt-3 h-1.5 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: ${Math.min(closures.today.length * 20, 100)}%"></div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-xs font-medium text-slate-400 uppercase tracking-wide">Upcoming</span>
                        <div class="w-8 h-8 bg-amber-50 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="text-3xl font-bold text-slate-800">${closures.upcoming.length}</div>
                    <div class="text-sm text-slate-500">Scheduled</div>
                    <div class="mt-3 h-1.5 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-amber-500 rounded-full" style="width: ${Math.min(closures.upcoming.length * 10, 100)}%"></div>
                    </div>
                </div>
            `;

            // Build 7-day forecast
            const forecast = build7DayForecast(closures);
            forecastEl.innerHTML = forecast.slice(0, 4).map((day, index) => {
                const isOpen = !day.blocked;
                const statusClass = isOpen ? 'bg-emerald-500' : 'bg-red-500';
                const statusText = isOpen ? 'OPEN' : 'CLOSED';
                const bgColor = isOpen ? 'bg-white border-slate-200' : 'bg-red-50 border-red-200';
                const textColor = isOpen ? 'text-emerald-600' : 'text-red-600';
                
                return `
                    <div class="${bgColor} rounded-xl border p-5 shadow-sm">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <div class="font-semibold text-slate-800">${day.dayName}</div>
                                <div class="text-xs text-slate-400">${day.date}</div>
                            </div>
                            <span class="${statusClass} text-white text-xs font-medium px-2.5 py-1 rounded">${statusText}</span>
                        </div>
                        <div class="text-lg font-semibold ${textColor}">
                            ${isOpen ? 'Bridge Open' : 'Bridge Closed'}
                        </div>
                        ${day.closures.length > 0 && isOpen ? `
                            <div class="text-xs text-slate-500 mt-1">
                                ${day.closures.length} ramp closure${day.closures.length > 1 ? 's' : ''}
                            </div>
                        ` : `
                            <div class="text-xs text-slate-400 mt-1">
                                ${isOpen ? 'No scheduled closures' : 'Plan alternate route'}
                            </div>
                        `}
                    </div>
                `;
            }).join('');

            // Show details if there are any closures
            let detailsHTML = '';

            if (closures.today.length > 0 || closures.upcoming.length > 0) {
                // Today's closures details
                if (closures.today.length > 0) {
                    detailsHTML += `
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-4">
                            <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                                <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                Today's Activity
                            </h2>
                            <div class="space-y-3">
                                ${closures.today.map(closure => `
                                    <a href="${closure.link}" target="_blank" 
                                       class="block p-4 bg-slate-50 hover:bg-slate-100 rounded-lg border border-slate-200 hover:border-primary transition-all">
                                        ${closure.bridgeBlocked ? 
                                            `<div class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-medium mb-2">
                                                <span class="w-1.5 h-1.5 bg-red-500 rounded-full"></span>
                                                BRIDGE BLOCKED
                                            </div>` : 
                                            `<div class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-600 rounded text-xs font-medium mb-2">
                                                <span class="w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                                Ramp/Exit Only
                                            </div>`
                                        }
                                        <div class="text-slate-700">${closure.description}</div>
                                        <div class="text-xs text-primary mt-2 font-medium">Click for details →</div>
                                    </a>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                // Upcoming closures
                if (closures.upcoming.length > 0) {
                    const upcomingBridgeClosures = closures.upcoming.filter(c => c.bridgeBlocked);
                    const upcomingMinor = closures.upcoming.filter(c => !c.bridgeBlocked);

                    if (upcomingBridgeClosures.length > 0) {
                        detailsHTML += `
                            <div class="bg-red-50 rounded-xl border border-red-200 p-6 mb-4">
                                <h2 class="text-lg font-semibold text-red-700 mb-4 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                    </svg>
                                    Upcoming Bridge Closures
                                </h2>
                                <div class="space-y-3">
                                    ${upcomingBridgeClosures.map(closure => `
                                        <a href="${closure.link}" target="_blank" 
                                           class="block p-4 bg-white hover:bg-red-100/50 rounded-lg border border-red-200 hover:border-red-400 transition-all">
                                            <div class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-medium mb-2">
                                                <span class="w-1.5 h-1.5 bg-red-500 rounded-full"></span>
                                                SCHEDULED CLOSURE
                                            </div>
                                            <div class="text-slate-700">${closure.description}</div>
                                            <div class="text-xs text-red-600 mt-2 font-medium">Click for dates/times →</div>
                                        </a>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    }

                    if (upcomingMinor.length > 0) {
                        detailsHTML += `
                            <details class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                                <summary class="text-lg font-semibold text-slate-700 cursor-pointer hover:text-slate-900 flex items-center gap-2">
                                    <svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                    </svg>
                                    Upcoming Ramp/Exit Closures (${upcomingMinor.length})
                                </summary>
                                <div class="space-y-3 mt-4">
                                    ${upcomingMinor.slice(0, 8).map(closure => `
                                        <a href="${closure.link}" target="_blank" 
                                           class="block p-4 bg-slate-50 hover:bg-slate-100 rounded-lg border border-slate-200 hover:border-primary transition-all text-sm">
                                            <div class="text-slate-700">${closure.description}</div>
                                        </a>
                                    `).join('')}
                                </div>
                                ${upcomingMinor.length > 8 ? `
                                    <div class="text-center mt-4">
                                        <a href="${SR520_URL}" target="_blank" 
                                           class="text-primary hover:underline text-sm font-medium">
                                            View all ${upcomingMinor.length} upcoming →
                                        </a>
                                    </div>
                                ` : ''}
                            </details>
                        `;
                    }
                }
            }

            detailsEl.innerHTML = detailsHTML;

            // Update timestamp
            const now = new Date();
            lastUpdatedEl.textContent = `Last updated: ${now.toLocaleTimeString()}`;
        }

        function build7DayForecast(closures) {
            const forecast = [];
            const today = new Date();
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                const dayName = i === 0 ? 'Today' : 
                               i === 1 ? 'Tom' : 
                               date.toLocaleDateString('en-US', { weekday: 'short' });
                
                const dateStr = date.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' });
                
                // Find closures for this day
                const dayClosures = [...closures.today, ...closures.upcoming].filter(closure => {
                    // This is simplified - in reality, you'd need to parse the dates from the closure descriptions
                    // For now, we'll check if today and it's in today's list, or if upcoming
                    if (i === 0) {
                        return closures.today.includes(closure);
                    }
                    // For upcoming days, we'd need to parse dates from descriptions
                    // This is a placeholder - real implementation would parse "Jan 3-4" etc.
                    return false;
                });
                
                const bridgeBlocked = dayClosures.some(c => c.bridgeBlocked);
                
                forecast.push({
                    dayName,
                    date: dateStr,
                    blocked: bridgeBlocked,
                    closures: dayClosures
                });
            }
            
            return forecast;
        }

        function showLoading() {
            document.getElementById('status').innerHTML = `
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-12 text-center">
                    <div class="animate-pulse">
                        <div class="w-16 h-16 bg-slate-200 rounded-full mx-auto mb-4"></div>
                        <div class="h-8 bg-slate-200 rounded w-48 mx-auto mb-3"></div>
                        <div class="h-4 bg-slate-100 rounded w-64 mx-auto"></div>
                    </div>
                    <p class="text-slate-400 mt-4">Checking bridge status...</p>
                </div>
            `;
            document.getElementById('stats').innerHTML = `
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 animate-pulse">
                    <div class="h-4 bg-slate-200 rounded w-24 mb-3"></div>
                    <div class="h-8 bg-slate-200 rounded w-16 mb-2"></div>
                    <div class="h-3 bg-slate-100 rounded w-20"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 animate-pulse">
                    <div class="h-4 bg-slate-200 rounded w-24 mb-3"></div>
                    <div class="h-8 bg-slate-200 rounded w-16 mb-2"></div>
                    <div class="h-3 bg-slate-100 rounded w-20"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 animate-pulse">
                    <div class="h-4 bg-slate-200 rounded w-24 mb-3"></div>
                    <div class="h-8 bg-slate-200 rounded w-16 mb-2"></div>
                    <div class="h-3 bg-slate-100 rounded w-20"></div>
                </div>
            `;
            document.getElementById('forecast').innerHTML = '';
            document.getElementById('details').innerHTML = '';
        }

        function showError() {
            document.getElementById('status').innerHTML = `
                <div class="bg-white rounded-2xl shadow-sm border border-red-200 p-12 text-center">
                    <div class="w-16 h-16 bg-red-100 rounded-full mx-auto mb-4 flex items-center justify-center">
                        <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                    </div>
                    <h2 class="text-xl font-semibold text-slate-800 mb-2">Unable to load status</h2>
                    <p class="text-slate-500 mb-6">Check your connection or try again</p>
                    <button onclick="fetchSR520Data()" 
                            class="px-6 py-2.5 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors">
                        Try Again
                    </button>
                </div>
            `;
            document.getElementById('stats').innerHTML = '';
            document.getElementById('forecast').innerHTML = '';
        }

        // Initial load
        fetchSR520Data();

        // Refresh every 2 minutes
        setInterval(fetchSR520Data, 120000);
    </script>
</body>
</html>
